要件定義 v1.1（MVP・シングル端末）
1) 目的
写真＋短い実話からAIが実話1＋フェイク2の三択を生成。

参加者は投票し、「何人（誰）が当てたか」だけを表示して会話を促す。

2) 体験フロー（改訂）
プレイヤー登録：名前入力欄／「＋」で行追加、「−」で削除（2〜8名）。

開始 → 出題者選択（登録済み名簿から1名選ぶ）。

写真アップ（撮影or端末から選択）。

対象選択＋実話入力：写真内の気になる1点をタップ→実話（〜200字）入力。

AI整形：120–160字に整形→OK/再編集。

AIフェイク生成：写真内の別要素を使ってフェイク2本生成。

三択クイズ表示：A/B/Cをシャッフル表示。

投票：名簿リストに「未投票/済」ステータス。名前タップ→A/B/C選択→確定。

正解発表：正解のカードを強調表示し、正解者数と名前一覧を表示（例：「3/6人：Aki, Ken, Mina」）。

次のラウンド：出題者を選び直す or 自動ローテ（任意トグル）。

3) 機能要件（FR）
FR-01 プレイヤー登録（追加/削除/並び替え、重複名チェック）。

FR-02 写真入力（最大5MB、縦横可、ローカル表示）。

FR-03 画像解析：写真内オブジェクト抽出（最大7件：label/色/位置/関連）。

FR-04 出題者UI：対象タップ＋実話テキスト入力。

FR-05 実話整形（事実改変なし・固有名詞一般化）。

FR-06 フェイク生成×2（写真内の別要素限定）。

FR-07 三択シャッフル表示。

FR-08 投票UI（名前→A/B/C→確定、未投票者カウント）。

FR-09 正解発表（正解者数と名前のみ表示、スコア蓄積なし）。

FR-10 ラウンド管理（開始/終了/履歴1件保持）。

FR-11 ローカル保存（sessionStorage：直前ラウンド状態の復元）。

4) 非機能要件（NFR）
NFR-01 応答時間：各生成3–6秒目標。

NFR-02 プライバシー：画像は縮小して送信、サーバー永続保存なし（MVP）。

NFR-03 セーフティ：差別・攻撃・卑語はプロンプトで抑止＋簡易NGフィルタ。

NFR-04 オフライン耐性：生成以外は操作可能。

5) 画面／コンポーネント
① Setup：名前入力リスト（＋/−）、開始ボタン（2名以上で有効）。

② 出題者選択：名簿一覧から1人。

③ 写真＆実話：写真プレビュー＋対象タップ／実話入力→「整形」。

④ 三択：A/B/Cカード（同デザイン）、下部に名簿（未投票/済）。

⑤ 結果：正解カード強調、**「正解 X/Y：名前…」**表示、次へ。

6) データ設計（ローカル最小）
json
コピーする
編集する
{
  "players": ["Hana","Ken","Miki"],
  "presenter": "Ken",
  "photoId": "blob:...",
  "objects": [{ "id":"o1","label":"赤いマグカップ","pos":"左前","color":"赤" }],
  "trueStory": "整形済み実話",
  "choices": [
    {"id":"A","text":"…"}, {"id":"B","text":"…"}, {"id":"C","text":"…"}
  ],
  "answer": "B",
  "votes": [{ "player":"Hana","choice":"A" }, { "player":"Miki","choice":"B" }]
}
正解者数は votes から算出。スコア履歴は保持しない。

7) OpenAI利用（プロンプト最小セット）
(1) 物体抽出 / Vision

css
コピーする
編集する
写真内の“人以外”の物体/植物/道具/家具を最大7つ、
{label, color/質感, pos(方位/前後), related[]}でJSON出力。文章は不要。
(2) 実話整形 / Text

コピーする
編集する
実話(<=200字)を誇張せず120-160字に整形。
個人特定情報や会社名は一般名詞化。本文のみ、です/ました調。
(3) フェイク生成×2 / Text

makefile
コピーする
編集する
参照可オブジェクト: {objects}
役割: 上記の“別要素”を核に、実話に紛らわしい架空エピソードを2本（各120–160字）。
写真外の要素は使わない／危険・下品・差別NG／固有名詞一般化。
本文のみ、番号付きで2本。
8) ステート遷移（簡易）
scss
コピーする
編集する
SETUP → PICK_PRESENTER → PHOTO_INPUT → TRUE_STORY_EDIT
→ TRUE_STORY_CONFIRM → GENERATE_FAKES → QUIZ_SHUFFLE
→ VOTING → REVEAL → PICK_PRESENTER(次ラウンド)
9) 受け入れ条件
A1：毎ラウンド必ず実話1＋フェイク2が生成される。

A2：三択は毎回ランダム順で表示される。

A3：投票完了時に正解者数と名前のみが表示される（スコアは表示しない）。

A4：ページ再読み込み後も直前ラウンドが復元される。

A5：不適切語が混入しない（目視テスト10回で0件）。